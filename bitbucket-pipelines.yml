options:
  max-time: 8
clone:
  depth: 1
pipelines:
  default:
    - step:
        name: Test Latest PHP
        image: php:latest
        artifacts:
          - /usr/local/bin/composer
          - vendor/**/*
        script:
          - apt-get update && apt-get install -y unzip
          - curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer
          - composer -V
          - composer install --no-interaction --classmap-authoritative --no-suggest --no-progress
          - composer update roave/security-advisories
          - php vendor/bin/phpunit -c phpunit.xml --coverage-text
          - php vendor/bin/phpcs --standard=ruleset.xml
    - step:
        name: Test PHP 7.1
        image: php:7.1
        script:
          - apt-get update && apt-get install -y unzip
          - curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer
          - composer install --no-interaction --classmap-authoritative --no-suggest --no-progress
          - php vendor/bin/phpunit -c phpunit.xml --coverage-text

